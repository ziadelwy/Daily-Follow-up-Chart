<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Discharge form</title>
    <link rel="stylesheet" href="index.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="database.js"></script>
    
    
    
    <style>
        body {
            font-family: 'Arial', 'Tahoma', sans-serif;
            background: #fff;
            margin: 0;
            padding: 0;
        }
        .container {
            width: 21cm;
            max-width: 21cm;
            margin: 0 auto;
            background: #fff;
            border: 1px solid #ccc;
            padding: 0.5cm;
            box-shadow: 0 0 10px #eee;
            font-size: 11px;
        }
        
        @media print {
            .container {
                width: 90%;
                max-width: none;
                margin: 0;
                padding: 0.3cm;
                box-shadow: none;
                border: none;
                font-size: 10px;
            }
            .no-print {
                display: none !important;
            }
            body {
                margin: 0;
                padding: 0;
                font-size: 10px;
            }
            table {
                font-size: 9px !important;
                margin-bottom: 3px !important;
            }
            th, td {
                padding: 1px 2px !important;
                font-size: 9px !important;
            }
            input, select {
                font-size: 8px !important;
                padding: 1px !important;
                border: 1px solid #ccc !important;
            }
            .title {
                font-size: 14px !important;
                padding: 4px 0 !important;
                margin-bottom: 5px !important;
            }
            .header {
                margin-bottom: 5px !important;
            }
            .header .unit, .header .hospital {
                font-size: 10px !important;
                padding: 2px 5px !important;
            }
            .signature-section {
                margin-top: 10px !important;
            }
            .signature-box {
                font-size: 9px !important;
            }
            .blue-cell {
                font-size: 9px !important;
                padding: 1px 2px !important;
            }
            .section-title {
                font-size: 9px !important;
                padding: 2px 0 !important;
            }
            .maternal-input, .maternal-select {
                font-size: 8px !important;
                min-width: 30px !important;
                max-width: 60px !important;
            }
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .header .unit {
            border: 1px solid #000;
            padding: 3px 8px;
            font-weight: bold;
            font-size: 11px;
        }
        .header .hospital {
            font-weight: bold;
            font-size: 13px;
        }
        .title {
            text-align: center;
            background: #2986d4;
            color: #fff;
            font-size: 16px;
            font-weight: bold;
            padding: 4px 0;
            margin-bottom: 8px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 5px;
            font-size: 10px;
            page-break-inside: avoid;
        }
        th, td {
            border: 1px solid #000;
            padding: 2px 3px;
            vertical-align: middle;
            word-wrap: break-word;
            overflow: hidden;
            font-size: 10px;
        }
        th {
            background: #2986d4;
            color: #fff;
            font-weight: bold;
            text-align: center;
        }
        .section-title {
            background: #e6f0fa;
            font-weight: bold;
            text-align: right;
            padding: 6px 0;
        }
        .no-border {
            border: none !important;
        }
        .blue-cell {
            background: #2986d4;
            color: #fff;
            font-weight: bold;
        }
        .center {
            text-align: center;
        }
        .left {
            text-align: left;
        }
        .right {
            text-align: right;
        }
        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        .signature-box {
            width: 30%;
            text-align: center;
            border-top: 1px solid #000;
            padding-top: 3px;
            font-size: 10px;
        }
        .footer-date {
            text-align: left;
            font-size: 15px;
            margin-top: 10px;
        }
        input[type="text"], select {
            border: 1px solid #fff !important;
            background: #fff;
            color: #222;
            font-size: 9px;
            padding: 1px;
            width: 100%;
            box-sizing: border-box;
            height: auto;
        }
        .maternal-input, .maternal-select {
            min-width: 40px;
            max-width: 70px;
            width: 95%;
            font-size: 9px;
            box-sizing: border-box;
            padding: 1px;
        }
    </style>






</head>
<body>
<div class="container">
    <div class="header">
        <div class="unit">Ÿàÿ≠ÿØÿ© ÿ≠ÿ∂ÿßŸÜÿßÿ™ ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ</div>
        <div class="title">Discharge summary</div>
        <div class="hospital">ŸÖÿ≥ÿ™ÿ¥ŸÅŸâ ÿ≤ŸÖÿ≤ŸÖ</div>
    </div>
    
    <!-- ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ŸÜŸÇŸÑ -->
    <div class="no-print" style="text-align: center; margin-bottom: 20px; padding: 10px; background-color: #f8f9fa; border-radius: 5px;">
        <button onclick="window.location.href='dashboard.html'" style="background-color: #27ae60; color: white; border: none; padding: 8px 16px; margin: 0 5px; border-radius: 4px; cursor: pointer; font-size: 14px;">üè† dashboard</button>
        <button onclick="window.location.href='index.html'" style="background-color: #2986d4; color: white; border: none; padding: 8px 16px; margin: 0 5px; border-radius: 4px; cursor: pointer; font-size: 14px;">ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑŸÖÿ™ÿßÿ®ÿπÿ©</button>
    </div>
    <!-- Hospital & Infant Data -->
    <table>
        <tr>
            <td class="blue-cell" rowspan="3" style="width: 80px; font-size:11px;">Hospital Data</td>
            <td class="blue-cell" style="width: 70px;">Treating Dr</td>
            <td style="width: 120px;">
                <select name="treating_dr" style="width:100%;font-size:10px;">
                    <option>ÿØ/ Ÿáÿ®ÿ© ÿßŸÑŸÖŸáÿØŸä</option>
                    <option>ÿØ/ </option>
                </select>
            </td>
            <td class="blue-cell" style="width: 80px;">Discharge Date</td>
            <td style="width: 80px;" id="discharge-date"></td>
            <td class="blue-cell" style="width: 80px;">Discharge Cause</td>
            <td style="width: 80px;">
                <select name="improvement" style="width:100%;font-size:10px;">
                    <option>Improvement</option>
                    <option>Referral</option>
                    <option>Died</option>
                    <option>--</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 60px;">File No</td>
            <td style="width: 80px;"><input type="text" name="file_no" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
       
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="3" style="width: 80px; font-size:11px;">Patient Data</td>
            <td class="blue-cell" style="width: 70px;">Patient Name</td>
            <td style="width: 120px;"><input type="text" name="patient_name" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td class="blue-cell" style="width: 50px;">Gender</td>
            <td style="width: 50px;"><input type="text" name="gender" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td class="blue-cell" style="width: 70px;">Birth Date</td>
            <td style="width: 80px;"><input type="text" name="birth_date" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td class="blue-cell" style="width: 80px;">Age on admission</td>
            <td style="width: 60px;"><input type="text" name="age_on_admission" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">Admission Date</td>
            <td style="width: 80px;"><input type="text" name="admission_date" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td class="blue-cell" style="width: 70px;">GA</td>
            <td style="width: 50px;"><input type="text" name="ga" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td class="blue-cell" style="width: 70px;">B WT</td>
            <td style="width: 60px;"><input type="text" name="b_wt" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td class="blue-cell" style="width: 80px;">Age on discharge</td>
            <td style="width: 60px;"><input type="text" name="age_on_discharge" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="3" style="width: 80px; font-size:11px;">Maternal Data</td>
            <td class="blue-cell" style="width: 70px;">Age</td>
            <td style="width: 50px;"><input type="text" name="age" class="maternal-input" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td class="blue-cell" style="width: 70px;">Gravida</td>
            <td style="width: 50px;">
                <select name="g" class="maternal-select" style="width:100%;font-size:10px;">
                    <option>G</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                    <option>8</option>
                    <option>9</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Para</td>
            <td style="width: 50px;">
                <select name="p" class="maternal-select" style="width:100%;font-size:10px;">
                    <option>P</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                    <option>8</option>
                    <option>9</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Abortion</td>
            <td style="width: 50px;">
                <select name="a" class="maternal-select" style="width:100%;font-size:10px;">
                    <option>A</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                    <option>8</option>
                    <option>9</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Living</td>
            <td style="width: 50px;">
                <select name="l" class="maternal-select" style="width:100%;font-size:10px;">
                    <option>L</option>
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                    <option>8</option>
                    <option>9</option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">Blood Gr</td>
            <td style="width: 50px;">
                <select name="blood_gr" class="maternal-select" style="width:100%;font-size:10px;">
                    <option>B +ve</option>
                    <option>A +ve</option>
                    <option>A -ve</option>
                    <option>B -ve</option>
                    <option>O +ve</option>
                    <option>O -ve</option>
                    <option>AB +ve</option>
                    <option>AB -ve</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">PROM</td>
            <td style="width: 50px;">
                <select name="prom" class="maternal-select" style="width:100%;font-size:10px;">
                    <option>NO</option>
                    <option>Yes</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">TORCH</td>
            <td style="width: 50px;">
                <select name="torch" class="maternal-select" style="width:100%;font-size:10px;">
                    <option>NO</option>
                    <option>Yes</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Hypertension</td>
            <td style="width: 50px;">
                <select name="hypertension" class="maternal-select" style="width:100%;font-size:10px;">
                    <option>NO</option>
                    <option>Yes</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">DM</td>
            <td style="width: 50px;">
                <select name="dm" class="maternal-select" style="width:100%;font-size:10px;">
                    <option>NO</option>
                    <option>Yes</option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">Thyroid</td>
            <td style="width: 50px;">
                <select name="thyroid" class="maternal-select" style="width:100%;font-size:10px;">
                    <option>NO</option>
                    <option>Yes</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">U/S</td>
            <td colspan="3" style="width: 150px;"><input type="text" name="us" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td class="blue-cell" style="width: 70px;">Medical/Surgical problem</td>
            <td colspan="3" style="width: 150px;"><input type="text" name="medical_surgical_problem" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="3" style="width: 80px; font-size:11px;">Delivery</td>
            <td class="blue-cell" style="width: 70px;">Date</td>
            <td style="width: 80px;" id="delivery-date"></td>
            <td class="blue-cell" style="width: 70px;">Type</td>
            <td style="width: 80px;">
                <select name="delivery_type" style="width:100%;font-size:10px;">
                    <option>C S</option>
                    <option>N V D</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Hospital</td>
            <td style="width: 120px;" id="delivery-hospital"></td>
            <td class="blue-cell" style="width: 70px;">APGAR Score</td>
            <td style="width: 50px;"><input type="text" name="apgar_score" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td class="blue-cell" style="width: 70px;">Resuscitation</td>
            <td style="width: 50px;">
                <select name="resuscitation" style="width:100%;font-size:10px;">
                    <option>Not Attended</option>
                    <option>Attended</option>
                </select>
            </td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="2" style="width: 80px; font-size:11px;">Diagnosis</td>
            <td class="blue-cell" style="width: 70px;">Admission Diagnosis</td>
            <td colspan="5"><input type="text" name="admission_diagnosis" list="diagnosisOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">Discharge Diagnosis</td>
            <td colspan="5"><input type="text" name="discharge_diagnosis" list="diagnosisOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="5" style="width: 80px; font-size:11px;">Problems</td>
            <td class="blue-cell" style="width: 70px;">Problem 1</td>
            <td colspan="5"><input type="text" name="problem1" list="problemOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">Problem 2</td>
            <td colspan="5"><input type="text" name="problem2" list="problemOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">Problem 3</td>
            <td colspan="5"><input type="text" name="problem3" list="problemOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">Problem 4</td>
            <td colspan="5"><input type="text" name="problem4" list="problemOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">Problem 5</td>
            <td colspan="5"><input type="text" name="problem5" list="problemOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="7" style="width: 80px; font-size:11px;">Examination</td>
            <td class="blue-cell" style="width: 70px;">Parameter</td>
            <td class="blue-cell" style="width: 100px;">On admission</td>
            <td class="blue-cell" style="width: 100px;">On discharge</td>
        </tr>
        <tr>
            <td class="blue-cell">General</td>
            <td><input type="text" name="general_on_admission" list="generalOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="general_on_discharge" list="generalOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">Head & Neck</td>
            <td><input type="text" name="head_neck_on_admission" list="headNeckOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="head_neck_on_discharge" list="headNeckOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">CNS</td>
            <td><input type="text" name="cns_on_admission" list="cnsOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="cns_on_discharge" list="cnsOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">CVS</td>
            <td><input type="text" name="cvs_on_admission" list="cvsOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="cvs_on_discharge" list="cvsOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">Respiratory</td>
            <td><input type="text" name="respiratory_on_admission" list="respiratoryOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="respiratory_on_discharge" list="respiratoryOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">Abdomen</td>
            <td><input type="text" name="abdomen_on_admission" list="abdomenOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="abdomen_on_discharge" list="abdomenOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">Limbs/Spine</td>
            <td><input type="text" name="limbs_spine_on_admission" list="limbsOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="limbs_spine_on_discharge" list="limbsOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="10" style="width: 80px; font-size:11px;">Significant Lab</td>
            <td class="blue-cell" style="width: 70px;">Parameter</td>
            <td class="blue-cell" style="width: 100px;">On admission</td>
            <td class="blue-cell" style="width: 100px;">In patient</td>
            <td class="blue-cell" style="width: 100px;">On discharge</td>
        </tr>
        <tr>
            <td class="blue-cell">HB</td>
            <td><input type="text" name="hb_on_admission" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="hb_in_patient" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="hb_on_discharge" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">Platelet</td>
            <td><input type="text" name="platelet_on_admission" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="platelet_in_patient" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="platelet_on_discharge" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">TLC</td>
            <td><input type="text" name="tlc_on_admission" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="tlc_in_patient" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="tlc_on_discharge" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">N</td>
            <td><input type="text" name="n_on_admission" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="n_in_patient" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="n_on_discharge" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">CRP</td>
            <td><input type="text" name="crp_on_admission" list="crpOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="crp_in_patient" list="crpOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="crp_on_discharge" list="crpOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">TSB</td>
            <td><input type="text" name="tsb_on_admission" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="tsb_in_patient" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="tsb_on_discharge" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">Blood C/S</td>
            <td><input type="text" name="blood_cs_on_admission" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="blood_cs_in_patient" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="blood_cs_on_discharge" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">Na/K/CA</td>
            <td><input type="text" name="nakca_on_admission" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="nakca_in_patient" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="nakca_on_discharge" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell">Others</td>
            <td><input type="text" name="others_on_admission" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="others_in_patient" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="others_on_discharge" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="3" style="width: 80px; font-size:11px;">Imaging</td>
            <td class="blue-cell" style="width: 70px;">X-ray</td>
            <td colspan="5"><input type="text" name="xray" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">U/S</td>
            <td colspan="5"><input type="text" name="us_imaging" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">Echo</td>
            <td colspan="5"><input type="text" name="echo" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="6" style="width: 80px; font-size:11px;">Medications</td>
            <td class="blue-cell" style="width: 150px;">Drug</td>
            <td class="blue-cell" style="width: 150px;">Duration</td>
            <td class="blue-cell" style="width: 150px;">Drug</td>
            <td class="blue-cell" style="width: 150px;">Duration</td>
        </tr>
        <tr>
            <td><input type="text" name="drug1" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="duration1" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="drug2" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="duration2" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td><input type="text" name="drug3" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="duration3" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="drug4" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="duration4" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td><input type="text" name="drug5" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="duration5" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="drug6" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="duration6" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td><input type="text" name="drug7" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="duration7" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="drug8" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="duration8" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
        <tr>
            <td><input type="text" name="drug9" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="duration9" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="drug10" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
            <td><input type="text" name="duration10" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="3" style="width: 80px; font-size:11px;">Respiratory Support</td>
            <td colspan="5"><input type="text" list="problemOptions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="3" style="width: 80px; font-size:11px;">Interventions</td>
            <td class="blue-cell" style="width: 70px;">Phototherapy</td>
            <td style="width: 50px;">
                <select name="phototherapy" style="width:100%;font-size:10px;">
                    <option>No</option>
                    <option>Yes</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Blood Exchange</td>
            <td style="width: 50px;">
                <select name="blood_exchange" style="width:100%;font-size:10px;">
                    <option>No</option>
                    <option>Yes</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Blood Transfusion</td>
            <td style="width: 50px;">
                <select name="blood_transfusion" style="width:100%;font-size:10px;">
                    <option>No</option>
                    <option>Yes</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Platelet Transfusion</td>
            <td style="width: 50px;">
                <select name="platelet_transfusion" style="width:100%;font-size:10px;">
                    <option>No</option>
                    <option>Yes</option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="blue-cell" style="width: 70px;">Plasma Transfusion</td>
            <td style="width: 50px;">
                <select name="plasma_transfusion" style="width:100%;font-size:10px;">
                    <option>No</option>
                    <option>Yes</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Cryo Transfusion</td>
            <td style="width: 50px;">
                <select name="cryo_transfusion" style="width:100%;font-size:10px;">
                    <option>No</option>
                    <option>Yes</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Lumbar Puncture</td>
            <td style="width: 50px;">
                <select name="lumbar_puncture" style="width:100%;font-size:10px;">
                    <option>No</option>
                    <option>Yes</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Others</td>
            <td style="width: 100px;"><input type="text" name="others_interventions" style="width:100%;font-size:10px;box-sizing:border-box;"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="3" style="width: 80px; font-size:11px;">Outcome</td>
            <td class="blue-cell" style="width: 70px;">Discharge Cause</td>
            <td style="width: 120px;">
                <select name="outcome" style="width:100%;font-size:10px;">
                    <option>Improvement</option>
                    <option>Referral</option>
                    <option>Died</option>
                </select>
            </td>
            <td class="blue-cell" style="width: 70px;">Date</td>
            <td style="width: 80px;" id="outcome_date"></td>
        </tr>
    </table>
    <table>
        <tr>
            <td class="blue-cell" rowspan="3" style="width: 80px; font-size:11px;">Follow up</td>
            <td colspan="5" id="follow-up-plan"></td>
        </tr>
    </table>
    <div class="signature-section">
        <div class="signature-box">ÿßŸÑÿ™ŸàŸÇŸäÿπ</div>
        <div class="signature-box">ÿßŸÑÿßÿ≥ŸÖ</div>
        <div class="signature-box">ÿßŸÑÿ™ÿßÿ±ŸäÿÆ</div>
    </div>
    <div class="footer-date" id="signature-date"></div>
</div>

<script>
  // ÿØÿßŸÑÿ© ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÅŸÑ
  async function fetchChildDataForDischarge() {
    const fileNo = document.querySelector('input[name="file_no"]').value.trim();
    const fileNoInput = document.querySelector('input[name="file_no"]');

    if (!fileNo) {
      clearDischargeFields();
      return;
    }

    fileNoInput.style.backgroundColor = '#fff3cd';
    fileNoInput.placeholder = 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ®ÿ≠ÿ´...';

    try {
      const children = await db.getChildren();
      console.log('ÿ™ŸÖ ÿ¨ŸÑÿ® ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ:', children);

      let child = null;
      for (const [id, c] of Object.entries(children)) {
        if (c.fileNo != null && String(c.fileNo).trim() === String(fileNo).trim()) {
          child = c;
          child.id = id;
          break;
        }
      }

      if (!child) {
        throw new Error('ÿ±ŸÇŸÖ ÿßŸÑŸÖŸÑŸÅ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™');
      }

      // ŸÖŸÑÿ° ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
      document.querySelector('input[name="patient_name"]').value = child.motherName || '';
      document.querySelector('input[name="gender"]').value = child.childType || '';
      document.querySelector('input[name="ga"]').value = child.gestationalAge || '';
      document.querySelector('input[name="b_wt"]').value = child.birthWeight || '';

      // ÿßŸÑÿ™Ÿàÿßÿ±ŸäÿÆ
      if (child.birthDate) {
        const bd = new Date(child.birthDate);
        document.querySelector('input[name="birth_date"]').value = bd.toLocaleDateString('ar-EG');
      }
      if (child.entryDate) {
        const ed = new Date(child.entryDate);
        const formatted = ed.toLocaleDateString('ar-EG');
        document.querySelector('input[name="admission_date"]').value = formatted;
        document.getElementById('delivery-date').textContent = formatted;
      }
      if (child.birthPlace) {
        document.getElementById('delivery-hospital').textContent = child.birthPlace;
      }

      // ÿßŸÑÿπŸÖÿ± ÿπŸÜÿØ ÿßŸÑÿØÿÆŸàŸÑ ŸàÿßŸÑÿÆÿ±Ÿàÿ¨
      if (child.birthDate) {
        const birth = new Date(child.birthDate);
        const admission = child.entryDate ? new Date(child.entryDate) : null;
        const today = new Date();

        if (admission) {
          const ageAdm = Math.floor((admission - birth) / (1000 * 60 * 60 * 24));
          document.querySelector('input[name="age_on_admission"]').value = ageAdm === 0 ? '1' : ageAdm;
        }
        const ageDis = Math.floor((today - birth) / (1000 * 60 * 60 * 24));
        document.querySelector('input[name="age_on_discharge"]').value = ageDis;
      }

      fileNoInput.style.backgroundColor = '#d4edda';
      fileNoInput.placeholder = 'ÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿßŸÑÿ∑ŸÅŸÑ';
      console.log('ÿ™ŸÖ ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÅŸÑ ÿ®ŸÜÿ¨ÿßÿ≠:', child);

    } catch (error) {
      console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿ¨ŸÑÿ® ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:', error);
      clearDischargeFields();
      fileNoInput.style.backgroundColor = '#f8d7da';
      fileNoInput.placeholder = 'ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ';
      alert('ÿÆÿ∑ÿ£: ' + error.message);
    }
  }

  // ÿØÿßŸÑÿ© ŸÖÿ≥ÿ≠ ÿßŸÑÿ≠ŸÇŸàŸÑ
  function clearDischargeFields() {
    document.querySelector('input[name="patient_name"]').value = "";
    document.querySelector('input[name="gender"]').value = "";
    document.querySelector('input[name="birth_date"]').value = "";
    document.querySelector('input[name="age_on_admission"]').value = "";
    document.querySelector('input[name="admission_date"]').value = "";
    document.querySelector('input[name="ga"]').value = "";
    document.querySelector('input[name="age_on_discharge"]').value = "";
    document.querySelector('input[name="b_wt"]').value = "";
    
    // ŸÖÿ≥ÿ≠ ÿ®ŸäÿßŸÜÿßÿ™ Delivery
    document.getElementById('delivery-date').textContent = "";
    document.getElementById('delivery-hospital').textContent = "";
    document.querySelector('select[name="delivery_type"]').value = "C S";
    
    // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ
    const fileNoInput = document.querySelector('input[name="file_no"]');
    if (fileNoInput) {
      fileNoInput.style.backgroundColor = '';
      fileNoInput.placeholder = '';
    }
  }

  // ÿØÿßŸÑÿ© ŸÖÿ≥ÿ≠ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÅŸä ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨
  function clearAllDischargeFields() {
    if (confirm('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ŸÖÿ≥ÿ≠ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÅŸä ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨ÿü')) {
      // ŸÖÿ≥ÿ≠ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÅŸÑ
      clearDischargeFields();
      
      // ŸÖÿ≥ÿ≠ ÿ≠ŸÇŸÑ ÿ±ŸÇŸÖ ÿßŸÑŸÖŸÑŸÅ
      const fileNoInput = document.querySelector('input[name="file_no"]');
      if (fileNoInput) {
        fileNoInput.value = "";
        fileNoInput.style.backgroundColor = '';
        fileNoInput.placeholder = '';
      }
      
      // ŸÖÿ≥ÿ≠ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ£ŸÖ
      document.querySelector('input[name="age"]').value = "";
      document.querySelector('select[name="g"]').value = "G";
      document.querySelector('select[name="p"]').value = "P";
      document.querySelector('select[name="a"]').value = "A";
      document.querySelector('select[name="l"]').value = "L";
      document.querySelector('select[name="blood_gr"]').value = "B +ve";
      document.querySelector('input[name="us"]').value = "";
      document.querySelector('input[name="medical_surgical_problem"]').value = "";
      
      // ŸÖÿ≥ÿ≠ ÿßŸÑÿ™ÿ¥ÿÆŸäÿµ
      document.querySelector('input[name="admission_diagnosis"]').value = "";
      document.querySelector('input[name="discharge_diagnosis"]').value = "";
      
      // ŸÖÿ≥ÿ≠ ÿßŸÑŸÖÿ¥ÿßŸÉŸÑ
      document.querySelectorAll('input[name^="problem"]').forEach(input => {
        input.value = "";
      });
      
      // ŸÖÿ≥ÿ≠ ÿßŸÑŸÅÿ≠ÿµ
      document.querySelectorAll('input[name*="on_admission"], input[name*="on_discharge"]').forEach(input => {
        input.value = "";
      });
      
      // ŸÖÿ≥ÿ≠ ÿßŸÑŸÖÿπÿßŸÖŸÑ
      document.querySelectorAll('input[name*="on_admission"], input[name*="in_patient"], input[name*="on_discharge"]').forEach(input => {
        input.value = "";
      });
      
      // ŸÖÿ≥ÿ≠ ÿßŸÑÿ£ÿ¥ÿπÿ©
      document.querySelector('input[name="xray"]').value = "";
      document.querySelector('input[name="us_imaging"]').value = "";
      document.querySelector('input[name="echo"]').value = "";
      
      // ŸÖÿ≥ÿ≠ ÿßŸÑÿ£ÿØŸàŸäÿ©
      document.querySelectorAll('input[name^="drug"], input[name^="duration"]').forEach(input => {
        input.value = "";
      });
      
      // ŸÖÿ≥ÿ≠ ÿßŸÑÿØÿπŸÖ ÿßŸÑÿ™ŸÜŸÅÿ≥Ÿä
      document.querySelector('input[list="problemOptions"]').value = "";
      
      // ŸÖÿ≥ÿ≠ ÿßŸÑÿ™ÿØÿÆŸÑÿßÿ™
      document.querySelectorAll('select').forEach(select => {
        if (select.name && !select.name.includes('treating_dr') && !select.name.includes('g') && 
            !select.name.includes('p') && !select.name.includes('a') && !select.name.includes('l') && 
            !select.name.includes('blood_gr')) {
          select.selectedIndex = 0;
        }
      });
      
      // ŸÖÿ≥ÿ≠ ÿßŸÑÿ™ŸàŸÇŸäÿπ
      document.querySelectorAll('input[type="text"]').forEach(input => {
        if (!input.name || !input.name.includes('file_no')) {
          input.value = "";
        }
      });
      
      alert('ÿ™ŸÖ ŸÖÿ≥ÿ≠ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠');
    }
  }

  // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ™ÿßÿ±ŸäÿÆ
  function setupDates() {
    const today = new Date('2025-10-31');
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, '0');
    const dd = String(today.getDate()).padStart(2, '0');
    
    document.getElementById('discharge-date').textContent = `${yyyy}-${mm}-${dd}`;
    document.getElementById('outcome_date').textContent = `${yyyy}-${mm}-${dd}`;
    document.getElementById('signature-date').textContent = `${dd}/${mm}/${yyyy}`;

    const followUpDate = new Date(today);
    followUpDate.setDate(today.getDate() + 2);
    const followUpDay = followUpDate.toLocaleDateString('ar-SA', { weekday: 'long' });
    const fdd = String(followUpDate.getDate()).padStart(2, '0');
    const fmm = String(followUpDate.getMonth() + 1).padStart(2, '0');
    const fyyy = followUpDate.getFullYear();

    document.getElementById('follow-up-plan').textContent = 
      `ÿßŸÑŸÖÿ™ÿßÿ®ÿπÿ© ÿØÿßÿÆŸÑ ÿ≠ÿ∂ÿßŸÜÿßÿ™ ÿ≤ŸÖÿ≤ŸÖ ŸäŸàŸÖ ${followUpDay} ÿßŸÑŸÖŸàÿßŸÅŸÇ ${fdd}/${fmm}/${fyyy} ÿßŸÑÿ≥ÿßÿπÿ© 4 ÿπÿµÿ±ÿß`;
  }

  document.addEventListener('DOMContentLoaded', function() {
    setupDates();

    const fileNoInput = document.querySelector('input[name="file_no"]');
    if (fileNoInput) {
      let searchTimeout;
      fileNoInput.addEventListener('input', function() {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(fetchChildDataForDischarge, 800);
      });
    }
  });
</script>
<datalist id="problemOptions">
  <option value="NJ‚û°Ô∏è‚û°Ô∏èPhototherapy"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èMV"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èMV‚û°Ô∏è‚û°Ô∏èNIMV"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èMV‚û°Ô∏è‚û°Ô∏èNIMV‚û°Ô∏è‚û°Ô∏èHFNC‚û°Ô∏è‚û°Ô∏èIO2‚û°Ô∏è‚û°Ô∏èOFF"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èMV‚û°Ô∏è‚û°Ô∏èNIMV‚û°Ô∏è‚û°Ô∏èNCMV‚û°Ô∏è‚û°Ô∏èHFNC"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èNIMV"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èNIMV‚û°Ô∏è‚û°Ô∏èMV"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èNIMV‚û°Ô∏è‚û°Ô∏èNCMV"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èNIMV‚û°Ô∏è‚û°Ô∏èHFNC"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èHFNC"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èHFNC‚û°Ô∏è‚û°Ô∏èHB"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èHFNC‚û°Ô∏è‚û°Ô∏èHB‚û°Ô∏è‚û°Ô∏èIO2‚û°Ô∏è‚û°Ô∏èOFF"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èHFNC‚û°Ô∏è‚û°Ô∏èNIMV‚û°Ô∏è‚û°Ô∏èMV"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏è-MV‚û°Ô∏è‚û°Ô∏èHFO"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èNC"></option>
  <option value="RD‚û°Ô∏è‚û°Ô∏èNC‚û°Ô∏è‚û°Ô∏èIO2‚û°Ô∏è‚û°Ô∏èOFF"></option>
</datalist>
<datalist id="diagnosisOptions">
  <option value="Female, FT , 37 w' , NJ"></option>
  <option value="Female, FT , 38 w' , RD"></option>
  <option value="Female, PT , 35 w' , RD"></option>
  <option value="Female, PT , 33 w' , RD"></option>
  <option value="Male, FT , 38 w' , RD"></option>
  <option value="Male, FT , 37 w' , NJ"></option>
  <option value="Male, FT , 37 w' , RD"></option>
  <option value="Male, NT , 36 w' , RD"></option>
  <option value="Male, PT , 33 w' , RD"></option>
  <option value="Male, PT , 32 w' , RD"></option>
  <option value="Male, PT , 34 w' , RD"></option>
  <option value="Male, PT , 31 w' , RD"></option>
</datalist>
<datalist id="generalOptions">
  <option value="MGC    -    SVS"></option>
  <option value="MGC"></option>
  <option value="CRITICAL - CYANOSIS"></option>
  <option value="BGC"></option>

</datalist>
<datalist id="headNeckOptions">
  <option value="NAD"></option>
  <option value="Hydrocephalus"></option>
  <option value="Icteric"></option>
</datalist>
<datalist id="cnsOptions">
  <option value="conscious , active"></option>
  <option value="CONSCIOUS - HYPOACTIVE"></option>
</datalist>
<datalist id="cvsOptions">
  <option value="S1 , S2 + M0"></option>
  <option value="S1 , S2 + SM"></option>
</datalist>
<datalist id="respiratoryOptions">
  <option value="BEAE , NO RD"></option>
  <option value="Decreased air entry bilateral , SCR , RD2"></option>
  <option value="Decreased air entry bilateral , SCR ,GRUNTING, RD3"></option>
</datalist>
<datalist id="abdomenOptions">
  <option value="lax , soft , tolerate oral feeding"></option>
  <option value="LAX , Soft"></option>
  <option value="lax soft mild distinsion"></option>
</datalist>
<datalist id="limbsOptions">
  <option value="NAD"></option>
</datalist>
<datalist id="crpOptions">
  <option value="Negative"></option>
  <option value="Positive"></option>
</datalist>

</body>
</html>
